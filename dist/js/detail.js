"use strict";requirejs.config({paths:{jquery:"../lib/jquery-3.4.1.min"}}),define("../api/server",["jquery"],function(i){return{getBannerData:function(){return i.ajax("/api/mock/banner.json")},getBanner2Data:function(){return i.ajax("/api/mock/banner2.json")},getPhoneData:function(){return i.ajax("/api/mock/phone.json")},getBookData:function(){return i.ajax("/api/mock/book.json")},getPadData:function(){return i.ajax("/api/mock/pad.json")},getDetailData:function(a,n){return new Promise(function(t,e){i.ajax("/api/mock/"+a+".json").then(function(e){for(var a=0;a<e.goods_list.length;a++)n==e.goods_list[a].goodsId&&t(e.goods_list[a])})})}}}),define("modules/banner",["jquery"],function(a){var t=a("#banner");return function(e){e="\n            <ul>\n                "+e.banner_list.map(function(e,a,t){return'\n                        <li class="'+(0==a?"show":"")+'"><a href="'+e.imgLink+'"><img src="'+e.imgUrl+'" alt=""></a></li>\n                        '}).join("")+"\n            </ul>\n            <ol>\n                "+e.banner_list.map(function(e,a,t){return'\n                        <li class="'+(0==a?"active":"")+'"></li>\n                        '}).join("")+'\n            </ol>\n            <div class="banner-mask"></div>\n        ',t.html(e),t.on("click","ol li",function(){a(this).attr("class","active").siblings().attr("class",""),t.find("ul li").eq(a(this).index()).attr("class","show").siblings().attr("class","")})}}),define("modules/cartStorge",["jquery"],function(e){var a="cartList";function s(e){return window.localStorage.setItem(a,JSON.stringify(e))}function r(){return JSON.parse(window.localStorage.getItem(a)||"[]")}return{addCartStorge:function(e,a){for(var t=r(),n=!1,i=-1,o=0;o<t.length;o++)t[o].goodsId==e.goodsId&&t[o].goodsColor==e.goodsColor&&(n=!0,i=o);n?t[i].goodsNumber+=e.goodsNumber:t.push(e),s(t),a()},setCartStorge:s,getCartStorge:r}}),requirejs.config({paths:{jquery:"../lib/jquery-3.4.1.min"}}),define("detail",["jquery","../api/server","./modules/banner","./modules/cartStorge"],function(s,e,a,t){var n=e.getBanner2Data,e=e.getDetailData,i=t.addCartStorge;n().then(function(e){a(e)});var t=location.search.match(/type=([^&]+)/)[1],n=location.search.match(/id=([^&]+)/)[1],o=s("#detail"),r=s("#detailGoods");e(t,n).then(function(e){var a,t;t='\n            <div class="detail_gallery l">\n                <div class="detail_gallery_normal">\n                    <img src="'+(a=e).photoNormal+'" alt="">\n                    <span></span>\n                </div>\n                <div class="detail_gallery_large">\n                    <img src="'+a.photoLarge+'" alt="">\n                </div>\n            </div>\n            <div class="detail_message l">\n                <h2>'+a.goodsName+'</h2>\n                <p>价 格 <span class="detail_message_price">¥'+a.goodsPrice+".00</span></p>\n                <p>选择颜色 \n                    "+a.chooseColor.map(function(e,a,t){return 0==a?'<span class="detail_message_box active">'+e+"</span>":'<span class="detail_message_box">'+e+"</span>"}).join("")+'\n                </p>\n                <div class="detail_message_btn clearfix">\n                    <div class="detail_message_num l">\n                        <input type="text" value="1">\n                        <span>+</span>\n                        <span>-</span>\n                    </div>\n                    <div class="detail_message_cart l"><a href="javascript:;">加入购物车</a></div>\n                    <div class="detail_message_computed l"><a href="/view/cart.html">立即下单</a></div>\n                </div>\n            </div>\n        ',e="\n            <h3>-- 商品详情 --</h3>\n            "+a.goodsInfo.map(function(e,a,t){return'<img src="'+e+'" alt="">'}).join(""),o.html(t),r.html(e),function(){var t=s(".detail_gallery_normal"),n=s(".detail_gallery_large"),i=s(".detail_gallery_large img"),o=s(".detail_gallery_normal span");t.hover(function(){o.show(),n.show()},function(){o.hide(),n.hide()}).mousemove(function(e){var a=e.pageX-t.offset().left-o.outerWidth()/2,e=e.pageY-t.offset().top-o.outerHeight()/2;a<0?a=0:a>t.outerWidth()-o.outerWidth()&&(a=t.outerWidth()-o.outerWidth()),e<0?e=0:e>t.height()-o.height()&&(e=t.height()-o.height()),o.css({left:a,top:e});a/=t.outerWidth()-o.outerWidth(),e/=t.outerHeight()-o.outerHeight();i.css({left:-a*(i.outerWidth()-n.outerWidth()),top:-e*(i.outerHeight()-n.outerHeight())})})}(),s(".detail_message_box").click(function(){s(this).addClass("active").siblings().removeClass("active")}),function(){var a=s(".detail_message_num input"),e=s(".detail_message_num span").eq(0),t=s(".detail_message_num span").eq(1);e.click(function(){var e=Number(a.val())+1;a.val(e)}),t.click(function(){var e=Number(a.val())-1;e<=0||a.val(e)}),a.on("input",function(){Number(s(this).val())||s(this).val("")}),a.on("blur",function(){Number(s(this).val())||s(this).val(1)})}(),function(t){o.find(".detail_message_cart").click(function(){var e=o.find(".detail_message_box").filter(".active"),a=o.find(".detail_message_num input"),a={goodsChecked:!0,goodsName:t.goodsName,goodsColor:e.html(),goodsPrice:t.goodsPrice,goodsNumber:Number(a.val()),goodsId:t.goodsId};console.log(a),i(a,function(){alert("添加购物车成功")})})}(a)})});